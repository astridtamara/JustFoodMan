<ion-header>
  <ion-navbar> <ion-title>Post Review</ion-title> </ion-navbar>
</ion-header>

<ion-content padding>
  <ion-row padding-horizontal class="card">
    <ion-col col-2>
      <img class="avatar" [src]="(profile | async)?.photo" />
    </ion-col>
    <ion-col col>
      <ion-row>
        <span class="account-name">{{ (profile | async)?.name }}</span>
      </ion-row>
      <ion-row>
        <span class="title-text "
          >Let the world hears your golden thought.</span
        >
      </ion-row>
    </ion-col>
  </ion-row>
  <form [formGroup]="reviewForm">
    <ion-row>
      <ion-col>
        <ion-item padding-right>
          <ion-label color="primary" stacked>Restaurant</ion-label>
          <ion-input
            type="text"
            formControlName="restaurant"
            placeholder="Where did you have your yum yum?"
            (click)="openRestaurantSelect()"
          ></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-item no-lines padding-right>
          <ion-label color="primary" stacked>Rating</ion-label>
          <ion-input type="hidden" formControlName="rating"></ion-input>
        </ion-item>
        <ion-row padding-left>
          <button
            ion-button
            clear
            small
            icon-only
            color="secondary"
            (click)="setRating(1)"
          >
            <ion-icon name="star"></ion-icon>
          </button>
          <button
            ion-button
            clear
            small
            icon-only
            [color]="
              reviewForm.controls.rating.value >= 2 ? 'secondary' : 'shadow'
            "
            (click)="setRating(2)"
          >
            <ion-icon name="star"></ion-icon>
          </button>
          <button
            ion-button
            clear
            small
            icon-only
            [color]="
              reviewForm.controls.rating.value >= 3 ? 'secondary' : 'shadow'
            "
            (click)="setRating(3)"
          >
            <ion-icon name="star"></ion-icon>
          </button>
          <button
            ion-button
            clear
            small
            icon-only
            [color]="
              reviewForm.controls.rating.value >= 4 ? 'secondary' : 'shadow'
            "
            (click)="setRating(4)"
          >
            <ion-icon name="star"></ion-icon>
          </button>
          <button
            ion-button
            clear
            small
            icon-only
            [color]="
              reviewForm.controls.rating.value >= 5 ? 'secondary' : 'shadow'
            "
            (click)="setRating(5)"
          >
            <ion-icon name="star"></ion-icon>
          </button>
        </ion-row>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-item padding-right>
          <ion-label color="primary" stacked>Review</ion-label>
          <ion-textarea
            type="text"
            formControlName="review"
            placeholder="Is it superb yum or nay? Please share :)"
            rows="8"
            maxLength="550"
          ></ion-textarea>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row justify-content-center align-items-center>
      <ion-col col-6 text-center>
        <img *ngIf="photoURL !== null" [src]="photoURL" />
        <button ion-button outline round (click)="onPictureEdit()">
          Upload Picture
        </button>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col text-center>
        <button ion-button round col-5 color="light" (click)="onCancel()">
          Cancel
        </button>
        <button
          ion-button
          col-5
          round
          color="secondary"
          (click)="onSubmit()"
          [disabled]="!reviewForm.valid"
        >
          Post
        </button>
      </ion-col>
    </ion-row>
  </form>
</ion-content>
